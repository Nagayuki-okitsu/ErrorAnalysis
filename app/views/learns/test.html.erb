<div class="content_box" align="center">
  <div class="around_box">

    <div class="resultbox">

        <p>ー第<%= session[:number] + 1 %>問ー</p>
        <p>プログラム</p>
        <p><%= @q["q_pro"] %></p>
        <p>エラー</p>
        <p><%= @q["q_err"] %></p>
        <p>問題</p>

        <% if @key == "c_a"%>    
            <p>ー原因を選択してくださいー</p>
        <% else %>
            <p>ー解決法を選択してくださいー</p>
        <% end %>

        <% if session[:check].present? %>

            <% if session[:check] == "correct" %>
                <p>正解</p>
            <% else %>
                <p>間違い</p>
            <% end %>

            <% for i in 0..3 %>
                <%= "(#{i+1})#{@q["#{@key}"][i]}" %><br>
            <% end %>

            正解 : （<%= session[:r_ans] %>）

            <% if session[:status] == "new" %>
                <%= button_to test_path, :class => 'ans_button', :method => :get , params: {status: "next"} do %>
                    <i class="fas fa-pen q_icon"></i>次へ
                <% end %>
            <% elsif session[:status] == "stay" %>

                解説 : <%= @q["ans"] %>

                <% if session[:number] + 1 == 3 %>

                    <% session[:status] = nil %>
                    <% session[:number] = nil %>
                    <% session[:q_arr_index] = nil %>
                    <% session[:r_ans] = nil %>
                    <% session[:q_order] = nil %>
                    <% session[:check] = nil %>

                    <%= button_to learn_path, :class => 'ans_button', :method => :get do %>
                        <i class="fas fa-pen q_icon"></i>終了
                    <% end %>
                <% else %>
                    <%= button_to test_path, :class => 'ans_button', :method => :get , params: {status: "change"} do %>
                        <i class="fas fa-pen q_icon"></i>次の問題へ
                    <% end %>
                <% end %>
            <% end %>

        <% else %>
            <%= form_with url: test_path, method: :get do |f| %>

                <%= f.radio_button :ans, :a %>
                <%= f.label :ans, "(1)#{@q["#{@key}"][0]}", {value: :a, style: "display: inline-block;"} %><br>

                <%= f.radio_button :ans, :b %>
                <%= f.label :ans, "(2)#{@q["#{@key}"][1]}", {value: :b, style: "display: inline-block;"} %><br>

                <%= f.radio_button :ans, :c %>
                <%= f.label :ans, "(3)#{@q["#{@key}"][2]}", {value: :c, style: "display: inline-block;"} %><br>

                <%= f.radio_button :ans, :d %>
                <%= f.label :ans, "(4)#{@q["#{@key}"][3]}", {value: :d, style: "display: inline-block;"} %><br>
    
                <%= button_tag type: :submit, :class => 'ans_button' do %><i class="fas fa-paper-plane"></i>送信<% end %>

            <% end %>
        <% end %>


    </div>

  </div>
</div>